---
managed_code_path: /opt/overview/managed-code
repositories:
  main:
    url: git@github.com:overview/overview-server.git
    build_command: 'play all/dist'
    clean_command: 'play all/clean'
    # unzip args: "-j" junk paths for flat output dir; "-d" destination directory; "-q" quiet
    export_command: 'unzip -q -j dist/overview*.zip "*.jar" -d #{DESTINATION_PATH}'
    copy:
      web: ''
      worker: ''
  config:
    url: git@github.com:overview/aws-overview-config.git
    build_command: '/opt/overview/managed-code/config/repo/generate.sh'
    clean_command: 'rm -rv generated/'
    build_env:
      OVERVIEW_SECRETS: /opt/overview/config/manage/secrets.yml
      OVERVIEW_CONFIG: /opt/overview/config/manage/config.yml
    export_command: 'cp -a generated/* #{DESTINATION_PATH}'
    copy:
      web: '#{ENV}/web'
      worker: '#{ENV}/worker'
      database: '#{ENV}/database'
